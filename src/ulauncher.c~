#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/stat.h>
#include <unistd.h>

void ulaunch() {
  int opt;
  printf("1 - DC Calc\n2 - Email\nEnter your option: ");
  scanf("%d", &opt);
  if (opt == 2) {
    struct stat st;
    char fp[1024];
    const char* HOME = getenv("HOME");
    snprintf(fp, sizeof(fp), "%s/.mycal/mail/bin/", HOME);
    if (stat(fp, &st) == 0 && S_ISDIR(st.st_mode)){
      system("wget https://github.com/Wdboyes13/MyCal/raw/refs/heads/main/other/rnm.sh");
      system("chmod +x rnm.sh");
      system("./rnm.sh");
      if (unlink("./rnm.sh") == 0){
	printf("Runner removed");
      } else {
	printf("Runner cleanup failed");
      }
      } else {
      system("wget https://github.com/Wdboyes13/MyCal/raw/refs/heads/main/other/inm.sh");
      system("chmod +x inm.sh");
      system("./inm.sh");
      system("wget https://github.com/Wdboyes13/MyCal/raw/refs/heads/main/other/muttconfig.sh");
      system("chmod +x muttconfig.sh");
      system("./muttconfig.sh");
      if(unlink("./inm.sh") == 0 && unlink("muttconfig.sh") == 0){
	printf("Mail installer removed");
      } else {
	printf("Installer cleanup failed");
      }
      ulaunch();
    }
  }
}
